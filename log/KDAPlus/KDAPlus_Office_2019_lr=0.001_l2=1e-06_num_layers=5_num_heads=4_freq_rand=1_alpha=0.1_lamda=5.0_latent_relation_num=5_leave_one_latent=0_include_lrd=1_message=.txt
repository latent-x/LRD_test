INFO:root:Namespace(model_name='KDAPlus')
INFO:root:--------------------------------------------- BEGIN: 2024-01-30 14:38:19 ---------------------------------------------
INFO:root:
=====================================
 Arguments           | Values        
=====================================
 alpha               | 0.1          
 attention_size      | 10           
 batch_size          | 256          
 buffer              | 1            
 dataset             | Office       
 dropout             | 0            
 early_stop          | 5            
 emb_size            | 64           
 epoch               | 200          
 eval_batch_size     | 256          
 freq_rand           | 1            
 gamma               | -1.0         
 gpu                 | 2            
 history_max         | 20           
 include_attr        | 1            
 include_kge         | 1            
 include_lrd         | 1            
 include_val         | 1            
 l2                  | 1e-06        
 lamda               | 5.0          
 latent_relation_num | 5            
 leave_one_latent    | 0            
 load                | 0            
 lr                  | 0.001        
 message             |              
 metric              | ["NDCG","HR"]
 n_dft               | 64           
 neg_head_p          | 0.5          
 num_heads           | 4            
 num_layers          | 5            
 num_neg             | 1            
 num_workers         | 5            
 only_predict        | 0            
 optimizer           | Adam         
 plm_name            | feat.GPT     
 plm_size            | 1536         
 pooling             | average      
 random_seed         | 2019         
 t_scalar            | 60           
 topk                | [5,10,50]    
=====================================
INFO:root:cuda available: True
INFO:root:# cuda devices: 1
INFO:root:Reading data from "../data/", dataset = "Office" 
INFO:root:Counting dataset statistics...
INFO:root:"# user": 4906, "# item": 2421, "# entry": 53258
INFO:root:Appending history info...
INFO:root:Constructing relation triplets...
INFO:root:Item-item relations:['r_complement', 'r_substitute']
INFO:root:Attribute-based relations:['i_category', 'i_brand']
INFO:root:"# relation": 10, "# triplet": 60706
INFO:root:Save corpus to ../data/Office/DFTReader_5.pkl
INFO:root:#params: 4336148
INFO:root:KDAPlus(
  (user_embeddings): Embedding(4906, 64)
  (item_embeddings): Embedding(2421, 1536, padding_idx=0)
  (project_layer_1): Linear(in_features=1536, out_features=64, bias=True)
  (project_layer_2): Linear(in_features=128, out_features=10, bias=True)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(10, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(10, 64)
    (freq_real): Embedding(10, 33)
    (freq_imag): Embedding(10, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.1032,HR@5:0.0542,HR@50:0.5011,NDCG@10:0.0475,NDCG@5:0.0319,NDCG@50:0.1305)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [4.773428   0.6956062  0.69312584]
INFO:root:Epoch 1     loss=4.7734 [6.1 s]	 dev=(HR@5:0.1068,NDCG@5:0.0626) test=(HR@5:0.0673,NDCG@5:0.0390) [2.2 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [4.6014585  0.67306226 0.69296145]
INFO:root:Epoch 2     loss=4.6015 [5.4 s]	 dev=(HR@5:0.0989,NDCG@5:0.0545) test=(HR@5:0.0640,NDCG@5:0.0351) [2.2 s] 
INFO:root:all_losses: [4.503389   0.66348064 0.6920861 ]
INFO:root:Epoch 3     loss=4.5034 [5.6 s]	 dev=(HR@5:0.2316,NDCG@5:0.1428) test=(HR@5:0.1686,NDCG@5:0.1035) [2.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [4.418589  0.659492  0.6898285]
INFO:root:Epoch 4     loss=4.4186 [5.5 s]	 dev=(HR@5:0.2718,NDCG@5:0.1676) test=(HR@5:0.2024,NDCG@5:0.1275) [2.2 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [4.3617873  0.6578987  0.68476653]
INFO:root:Early stop manually
