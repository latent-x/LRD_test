INFO:root:Namespace(model_name='RCF')
INFO:root:--------------------------------------------- BEGIN: 2024-01-30 15:35:08 ---------------------------------------------
INFO:root:
=====================================
 Arguments           | Values        
=====================================
 alpha               | 0.1          
 attention_size      | 10           
 batch_size          | 256          
 buffer              | 1            
 dataset             | Office       
 dropout             | 0            
 early_stop          | 5            
 emb_size            | 64           
 epoch               | 200          
 eval_batch_size     | 256          
 gamma               | -1.0         
 gpu                 | 2            
 history_max         | 20           
 include_attr        | 1            
 include_kge         | 1            
 include_lrd         | 0            
 include_val         | 1            
 l2                  | 1e-06        
 lamda               | 10           
 latent_relation_num | 5            
 leave_one_latent    | 0            
 load                | 0            
 lr                  | 0.0001       
 message             |              
 metric              | ["NDCG","HR"]
 neg_head_p          | 0.5          
 num_heads           | 4            
 num_layers          | 5            
 num_neg             | 1            
 num_workers         | 5            
 only_predict        | 0            
 optimizer           | Adam         
 plm_name            | feat.GPT     
 plm_size            | 1536         
 pooling             | average      
 random_seed         | 2019         
 topk                | [5,10,50]    
=====================================
INFO:root:cuda available: True
INFO:root:# cuda devices: 1
INFO:root:Load corpus from ../data/Office/KGReader_5.pkl
INFO:root:#params: 517174
INFO:root:RCF(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(10, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(10, 64)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0934,HR@5:0.0406,HR@50:0.5111,NDCG@10:0.0393,NDCG@5:0.0225,NDCG@50:0.1260)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.4405068 0.        0.6931472]
INFO:root:Epoch 1     loss=1.4405 [4.7 s]	 dev=(HR@5:0.1174,NDCG@5:0.0716) test=(HR@5:0.0775,NDCG@5:0.0456) [2.3 s] 
INFO:root:Save model to ../model/RCF/RCF_Office_2019_lr=0.0001_l2=1e-06_nu...
INFO:root:all_losses: [1.3559549 0.        0.6931468]
INFO:root:Epoch 2     loss=1.3560 [4.3 s]	 dev=(HR@5:0.1172,NDCG@5:0.0709) test=(HR@5:0.0756,NDCG@5:0.0442) [2.3 s] 
INFO:root:all_losses: [1.3000352  0.         0.69314533]
INFO:root:Epoch 3     loss=1.3000 [4.8 s]	 dev=(HR@5:0.1170,NDCG@5:0.0693) test=(HR@5:0.0712,NDCG@5:0.0418) [2.3 s] 
INFO:root:all_losses: [1.2615825 0.        0.6931407]
INFO:root:Epoch 4     loss=1.2616 [4.6 s]	 dev=(HR@5:0.1223,NDCG@5:0.0742) test=(HR@5:0.0781,NDCG@5:0.0463) [2.3 s] 
INFO:root:Save model to ../model/RCF/RCF_Office_2019_lr=0.0001_l2=1e-06_nu...
INFO:root:all_losses: [1.2316916  0.         0.69312817]
INFO:root:Epoch 5     loss=1.2317 [4.6 s]	 dev=(HR@5:0.1382,NDCG@5:0.0851) test=(HR@5:0.0966,NDCG@5:0.0562) [2.3 s] 
INFO:root:Save model to ../model/RCF/RCF_Office_2019_lr=0.0001_l2=1e-06_nu...
INFO:root:all_losses: [1.2115177 0.        0.693105 ]
INFO:root:Epoch 6     loss=1.2115 [4.6 s]	 dev=(HR@5:0.1556,NDCG@5:0.0949) test=(HR@5:0.1068,NDCG@5:0.0642) [2.4 s] 
INFO:root:Save model to ../model/RCF/RCF_Office_2019_lr=0.0001_l2=1e-06_nu...
INFO:root:all_losses: [1.1939619  0.         0.69306886]
INFO:root:Epoch 7     loss=1.1940 [4.7 s]	 dev=(HR@5:0.1735,NDCG@5:0.1064) test=(HR@5:0.1205,NDCG@5:0.0732) [2.3 s] 
INFO:root:Save model to ../model/RCF/RCF_Office_2019_lr=0.0001_l2=1e-06_nu...
INFO:root:all_losses: [1.1758229  0.         0.69301605]
INFO:root:Epoch 8     loss=1.1758 [4.5 s]	 dev=(HR@5:0.1865,NDCG@5:0.1169) test=(HR@5:0.1341,NDCG@5:0.0855) [2.3 s] 
INFO:root:Save model to ../model/RCF/RCF_Office_2019_lr=0.0001_l2=1e-06_nu...
INFO:root:all_losses: [1.1607116  0.         0.69296014]
INFO:root:Epoch 9     loss=1.1607 [4.6 s]	 dev=(HR@5:0.1902,NDCG@5:0.1217) test=(HR@5:0.1384,NDCG@5:0.0888) [2.3 s] 
INFO:root:Save model to ../model/RCF/RCF_Office_2019_lr=0.0001_l2=1e-06_nu...
INFO:root:all_losses: [1.1522804 0.        0.6928644]
INFO:root:Epoch 10    loss=1.1523 [4.6 s]	 dev=(HR@5:0.2002,NDCG@5:0.1300) test=(HR@5:0.1445,NDCG@5:0.0944) [2.4 s] 
INFO:root:Save model to ../model/RCF/RCF_Office_2019_lr=0.0001_l2=1e-06_nu...
INFO:root:all_losses: [1.1420939  0.         0.69275963]
